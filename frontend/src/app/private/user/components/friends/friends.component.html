<app-nav-bar></app-nav-bar>
<div class="container" (click)="closeContextMenu()">
  <div class="search">
    <div class="title">
      <h1>Chercher</h1>
      <img src="../../../../../assets/images/icons8-telescope-100_1.png" alt="icons8-telescope-100_1">
    </div>
    <hr>
    <input type="text" [(ngModel)]="searchTerm"  (ngModelChange)="searchUsers()" placeholder="Rechercher des utilisateurs">
    <div class="main">
      <div class="suggestions" *ngIf="filteredUsers.length > 0">
        <ul>
          <li *ngFor="let user of filteredUsers" (contextmenu)="onContextMenu($event, user.id)">
            <img src="../../../../../../assets/images/astronaut.png" alt="Photo de profil de {{user.username}}" >
            {{user.username}}
          </li>
        </ul>
      </div> 
    </div>
  </div>
  <div class="friend-list">
    <div class="title">
      <h1>Amis</h1>
      <img src="../../../../../assets/images/src.png" alt="amis-logo">
    </div>
    <hr>
    <p *ngIf="message">{{message}}</p>
    <div class="main">
      <ul>
        <li *ngFor="let friend of friends" (contextmenu)="onContextMenu($event, friend)">
          <img src="../../../../../../assets/images/astronaut.png">
          {{ friend }}
        </li>
        </ul>
    </div>
  </div>
</div>


<div *ngIf="showContextMenu" class="context-menu" [style.top.px]="contextMenuTop" [style.left.px]="contextMenuLeft">
  <button *ngIf="isMyFriend" (click)="addFriend(user.id, selectedUser)">add friend</button>
  <button >send message</button>
  <button (click)="removeFriend(user.id, selectedUser)">delete friend</button>
</div>


<!--
export class PlayerService {

  user$: Observable<UserI>;
  friends$: Observable<string[]>;

  constructor(
    private userService: UserService,
    private authService: AuthService,
    private httpClient : HttpClient
  ) {
    const userId = this.authService.getLoggedInUser().id;
    this.user$ = this.httpClient.get<UserI>(`/api/users/${userId}`);

    this.friends$ = this.user$.pipe(
      map(user => user.friend)
    );
  }

  getUser(): Observable<UserI> {
    const userId = this.authService.getLoggedInUser().id;
    return this.httpClient.get<UserI>(`/api/users/${userId}`);
  }

  addWin(id: number) {
    return this.httpClient.post(`api/users/${id}/addwins/`, null);
  }

  addLosses(id: number) {
    return this.httpClient.post(`api/users/${id}/addlosses/`, null);
  }

  addFriend(id: number, username: string) {
    return this.httpClient.post(`api/users/${id}/add-friend/`,null);
  }

  updatePassword(userId: number, oldPassword: string, newPassword: string): Observable<UserI> {
    return this.httpClient.put<UserI>(`api/users/${userId}/change-password`,{oldPassword, newPassword});
  }

  updateEmail(userId: number, oldEmail: string, newEmail: string): Observable<UserI> {
    return this.httpClient.put<UserI>(`api/users/${userId}/change-email`,{oldEmail, newEmail});
  }

  updateUsername(userId: number, newUsername: string): Observable<UserI> {
    return this.httpClient.put<UserI>(`api/users/${userId}/change-username`,{newUsername});
  }

  getUserList() : Observable<UserI[]> {
    return this.httpClient.get<UserI[]>(`api/users/all`);
  }
}
Et voici la partie HTML améliorée pour afficher la liste d'amis :

php
Copy code
<div class="friend-list">
  <div class="title">
    <h1>Amis</h1>
    <img src="../../../../../assets/images/src.png" alt="amis-logo">
  </div>
  <hr>
  <p *ngIf="message">{{message}}</p>
  <div class="main">
    <ul>
      <li *ngFor="let friend of friends$ | async; let i = index" (click)="goToProfileOf(friend)" (contextmenu)="onContextMenu($event, friend)">
        <img src="../../../../../../assets/images/astronaut.png">
        {{ friend }}
      </li>
    </ul>
  </div>
</div>
Dans cette version, nous avons créé un observable friends$ qui émettra un tableau de chaînes de caractères représentant la liste d'amis à chaque fois que l'utilisateur sera chargé. Pour afficher cette liste, nous utilisons une directive async qui prend l'observable friends$ et qui automatiquement s'abonne et se désabonne en fonction du cycle de vie du composant. Nous pouvons donc facilement afficher les amis de l'utilisateur en utilisant un simple *ngFor qui parcourt les chaînes de caractères émises par l'observable. -->
